# Issue Display Improvements

## æ¦‚è¿°

å·²å¢å¼º Git å˜æ›´åˆ†æé¢æ¿ä¸­çš„ issue æ˜¾ç¤ºï¼Œç°åœ¨æ˜¾ç¤ºæ›´è¯¦ç»†çš„ä¿¡æ¯å’Œå»ºè®®çš„è§£å†³æ–¹æ¡ˆã€‚

## æ”¹è¿›å†…å®¹

### 1. **å¢å¼ºçš„ Issue å¡ç‰‡å¸ƒå±€**

#### ä¹‹å‰:
- ç®€å•çš„å•è¡Œæ ‡é¢˜æ˜¾ç¤º
- æœ‰é™çš„ä¿¡æ¯å±•ç¤º
- å»ºè®®ä¿¡æ¯ä¸å¤Ÿæ˜¾çœ¼

#### ç°åœ¨:
- **åˆ†å±‚çš„å¡ç‰‡å¸ƒå±€**ï¼ŒåŒ…å«å¤šä¸ªæ¸…æ™°çš„åŒºåŸŸ
- **æ›´ä¸°å¯Œçš„æ ‡ç­¾ç³»ç»Ÿ**ï¼ŒåŒ…å«è§„åˆ™ ID
- **ç‹¬ç«‹çš„è§£å†³æ–¹æ¡ˆåŒºå—**ï¼Œæ›´åŠ æ˜¾çœ¼

### 2. **æ–°å¢æ˜¾ç¤ºå­—æ®µ**

#### Header åŒºåŸŸ
```
[CRITICAL] [ğŸ› Bug] [SONARQUBE] [ğŸ“‹ javascript:S1234]  â±ï¸ 5min
```
- Severity badge (ä¸¥é‡æ€§æ ‡ç­¾)
- Type badge with icon (å¸¦å›¾æ ‡çš„ç±»å‹æ ‡ç­¾)
- Source badge (æ¥æºæ ‡ç­¾)
- Rule ID badge (è§„åˆ™ ID æ ‡ç­¾) - **æ–°å¢**
- Effort estimation (é¢„ä¼°ä¿®å¤æ—¶é—´)

#### Issue Message (é—®é¢˜æ¶ˆæ¯)
```
Issue: Variable 'x' is never used and should be removed.
```
- æ¸…æ™°çš„æ ‡ç­¾ "Issue:"
- åŠ ç²—æ˜¾ç¤ºä»¥çªå‡ºé‡è¦æ€§

#### Detailed Description (è¯¦ç»†æè¿°) - **æ–°å¢ç‹¬ç«‹åŒºå—**
```
ğŸ“– Detailed Description
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
This unused variable increases code complexity and may indicate
a logic error or incomplete implementation.
```
- ä¸“ç”¨çš„ç°è‰²èƒŒæ™¯åŒºå—
- æ ‡é¢˜å›¾æ ‡å¢å¼ºå¯è¯»æ€§
- æ›´å¤§çš„å­—ä½“å’Œæ›´å¥½çš„è¡Œé«˜

#### Location (ä½ç½®ä¿¡æ¯)
```
ğŸ“‚ src/utils/helper.ts [Line 42]
```
- æ–‡ä»¶å›¾æ ‡
- é«˜äº®çš„è¡Œå·æ ‡ç­¾
- å¯ç‚¹å‡»è·³è½¬åˆ°ä»£ç ä½ç½®

#### Suggested Solution (å»ºè®®è§£å†³æ–¹æ¡ˆ) - **æ–°å¢ç‹¬ç«‹åŒºå—**
```
ğŸ’¡ Suggested Solution
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Remove the unused variable declaration or implement the missing
logic that should use this variable.
```
- ç»¿è‰²ä¸»é¢˜çš„è§£å†³æ–¹æ¡ˆåŒºå—
- å·¦ä¾§è¾¹æ¡†å¼ºè°ƒ
- ä¿ç•™æ¢è¡Œæ ¼å¼ (pre-wrap)

#### Metadata (å…ƒæ•°æ®) - **æ–°å¢**
```
ğŸ” Detected by SonarQube static analysis Â· Rule: javascript:S1234
```
- æ£€æµ‹æ¥æºè¯´æ˜
- è§„åˆ™ä»£ç æ˜¾ç¤º
- ç°è‰²åˆ†éš”çº¿åŒºåˆ†

### 3. **è§†è§‰æ”¹è¿›**

#### é…è‰²æ–¹æ¡ˆ
- **Critical**: `#ff0000` (çº¢è‰²)
- **High**: `#ffa500` (æ©™è‰²)
- **Medium**: `#ffff00` (é»„è‰²)
- **Low**: `#90ee90` (æµ…ç»¿è‰²)
- **Info**: `#87ceeb` (å¤©è“è‰²)

#### å¸ƒå±€æ”¹è¿›
- **Header**: ç‹¬ç«‹çš„æ·±è‰²èƒŒæ™¯ï¼ŒåŒ…å«æ‰€æœ‰æ ‡ç­¾
- **Content**: ç™½è‰²/æµ…è‰²èƒŒæ™¯ï¼ŒåŒ…å«ä¸»è¦å†…å®¹
- **Description**: æµ…ç°è‰²èƒŒæ™¯åŒºå—
- **Solution**: æµ…ç»¿è‰²èƒŒæ™¯åŒºå—ï¼ˆçªå‡ºè§£å†³æ–¹æ¡ˆï¼‰
- **Metadata**: é¡¶éƒ¨è¾¹æ¡†åˆ†éš”çš„åº•éƒ¨åŒºåŸŸ

### 4. **æ–°å¢å›¾æ ‡ç³»ç»Ÿ**

| ç±»å‹ | å›¾æ ‡ | æè¿° |
|------|------|------|
| Bug | ğŸ› | ä»£ç ç¼ºé™· |
| Vulnerability | ğŸ”’ | å®‰å…¨æ¼æ´ |
| Code Smell | ğŸ‘ƒ | ä»£ç å¼‚å‘³ |
| Security Hotspot | ğŸ”¥ | å®‰å…¨çƒ­ç‚¹ |
| Breaking Change | âš ï¸ | ç ´åæ€§å˜æ›´ |
| Performance | âš¡ | æ€§èƒ½é—®é¢˜ |
| Architecture | ğŸ—ï¸ | æ¶æ„é—®é¢˜ |
| Testing | ğŸ§ª | æµ‹è¯•ç›¸å…³ |

### 5. **ä»£ç ç»“æ„æ”¹è¿›**

#### æ–°å¢è¾…åŠ©å‡½æ•°

1. **`_formatIssueType()`**
   - å°†é—®é¢˜ç±»å‹è½¬æ¢ä¸ºå¸¦å›¾æ ‡çš„å‹å¥½æ˜¾ç¤º
   - æ”¯æŒ 8 ç§é—®é¢˜ç±»å‹

2. **`_getIssueMetadata()`**
   - ç”Ÿæˆå…ƒæ•°æ®åŒºå—
   - æ˜¾ç¤ºæ¥æºå’Œè§„åˆ™ä¿¡æ¯
   - å¯æ‰©å±•ä»¥æ·»åŠ æ›´å¤šå…ƒæ•°æ®

#### æ”¹è¿›çš„æ•°æ®å±æ€§
```html
<div class="issue" 
     data-severity="critical" 
     data-type="bug" 
     data-source="sonarqube">
```
- æ·»åŠ  `data-type` å’Œ `data-source` å±æ€§
- æ”¯æŒæœªæ¥çš„è¿‡æ»¤åŠŸèƒ½

## ä½¿ç”¨ç¤ºä¾‹

### SonarQube Issue å®Œæ•´æ˜¾ç¤º

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [CRITICAL] [ğŸ› Bug] [SONARQUBE] [ğŸ“‹ squid:S2259] â±ï¸ 8min â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Issue: Possible NullPointerException                    â”‚
â”‚                                                         â”‚
â”‚ ğŸ“– Detailed Description                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ The variable "user" may be null at this location.  â”‚ â”‚
â”‚ â”‚ Accessing properties without null check can cause  â”‚ â”‚
â”‚ â”‚ runtime exceptions.                                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ ğŸ“‚ src/services/user-service.ts [Line 146]             â”‚
â”‚                                                         â”‚
â”‚ ğŸ’¡ Suggested Solution                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Add null check before accessing properties:        â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚ if (user !== null) {                               â”‚ â”‚
â”‚ â”‚   return user.name;                                â”‚ â”‚
â”‚ â”‚ }                                                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ ğŸ” Detected by SonarQube Â· Rule: squid:S2259          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AI Issue å®Œæ•´æ˜¾ç¤º

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [HIGH] [âš¡ Performance] [AI]                    â±ï¸ 15min â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Issue: Inefficient database query in loop              â”‚
â”‚                                                         â”‚
â”‚ ğŸ“– Detailed Description                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Executing database queries inside a loop is         â”‚ â”‚
â”‚ â”‚ inefficient and can cause performance issues with   â”‚ â”‚
â”‚ â”‚ large datasets. This creates N+1 query problem.     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚ ğŸ“‚ src/repositories/order-repository.ts [Line 89]      â”‚
â”‚                                                         â”‚
â”‚ ğŸ’¡ Suggested Solution                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Use batch query or JOIN to fetch all required data â”‚ â”‚
â”‚ â”‚ in a single database call:                          â”‚ â”‚
â”‚ â”‚                                                     â”‚ â”‚
â”‚ â”‚ const orders = await db.query(                     â”‚ â”‚
â”‚ â”‚   'SELECT * FROM orders WHERE id IN (?)',          â”‚ â”‚
â”‚ â”‚   [orderIds]                                       â”‚ â”‚
â”‚ â”‚ );                                                  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ ğŸ¤– Detected by AI code review                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æŠ€æœ¯å®ç°

### HTML ç»“æ„
```html
<div class="issue critical" data-severity="critical" data-type="bug" data-source="sonarqube">
  <div class="issue-header">
    <div class="issue-badges">
      <span class="severity-badge critical">CRITICAL</span>
      <span class="type-badge">ğŸ› Bug</span>
      <span class="source-badge">SONARQUBE</span>
      <span class="rule-badge">ğŸ“‹ squid:S2259</span>
    </div>
    <span class="issue-effort">â±ï¸ 8min</span>
  </div>
  
  <div class="issue-content">
    <div class="issue-message">
      <strong>Issue:</strong> Possible NullPointerException
    </div>
    
    <div class="issue-description-section">
      <div class="section-title">ğŸ“– Detailed Description</div>
      <div class="issue-description">...</div>
    </div>
    
    <div class="issue-location-section">
      <span class="issue-location">ğŸ“‚ file.ts <span class="line-number">Line 146</span></span>
    </div>
    
    <div class="issue-solution-section">
      <div class="section-title">ğŸ’¡ Suggested Solution</div>
      <div class="issue-suggestion">...</div>
    </div>
    
    <div class="issue-metadata">
      <span class="metadata-item">ğŸ” Detected by SonarQube</span> Â·
      <span class="metadata-item">Rule: <code>squid:S2259</code></span>
    </div>
  </div>
</div>
```

### CSS å…³é”®æ ·å¼
```css
.issue {
  border-left: 4px solid;  /* å·¦ä¾§å½©è‰²è¾¹æ¡† */
  border-radius: 6px;
  overflow: hidden;
}

.issue-header {
  background-color: rgba(0, 0, 0, 0.1);  /* æ·±è‰² header */
  border-bottom: 1px solid;
}

.issue-description-section {
  background-color: rgba(0, 0, 0, 0.05);  /* æµ…ç°è‰²èƒŒæ™¯ */
}

.issue-solution-section {
  background-color: rgba(76, 175, 80, 0.1);  /* æµ…ç»¿è‰²èƒŒæ™¯ */
  border-left: 3px solid #4caf50;
}
```

## å‘åå…¼å®¹æ€§

- âœ… æ‰€æœ‰å­—æ®µéƒ½æ˜¯å¯é€‰çš„
- âœ… å¦‚æœå­—æ®µä¸å­˜åœ¨ï¼Œå¯¹åº”åŒºå—ä¸æ˜¾ç¤º
- âœ… ä¿æŒä¸ç°æœ‰ CodeIssue æ¥å£å®Œå…¨å…¼å®¹
- âœ… ä¸éœ€è¦æ›´æ”¹åç«¯ä»£ç 

## æµ‹è¯•å»ºè®®

1. **æ˜¾ç¤ºæµ‹è¯•**
   - åˆ›å»ºåŒ…å«æ‰€æœ‰å­—æ®µçš„ issue
   - åˆ›å»ºåªæœ‰éƒ¨åˆ†å­—æ®µçš„ issue
   - éªŒè¯å„ä¸ªåŒºå—æ­£ç¡®æ˜¾ç¤º/éšè—

2. **äº¤äº’æµ‹è¯•**
   - ç‚¹å‡»æ–‡ä»¶ä½ç½®èƒ½æ­£ç¡®è·³è½¬
   - è¿‡æ»¤åŠŸèƒ½æ­£å¸¸å·¥ä½œ
   - å¯¼å‡ºåŠŸèƒ½åŒ…å«æ‰€æœ‰ä¿¡æ¯

3. **è§†è§‰æµ‹è¯•**
   - ä¸åŒä¸¥é‡æ€§çš„é¢œè‰²æ­£ç¡®
   - æ·±è‰²/æµ…è‰²ä¸»é¢˜éƒ½æ­£å¸¸æ˜¾ç¤º
   - å“åº”å¼å¸ƒå±€æ­£å¸¸

## æœªæ¥æ”¹è¿›æ–¹å‘

1. **å¯æŠ˜å çš„è¯¦ç»†ä¿¡æ¯**
   - å…è®¸ç”¨æˆ·æŠ˜å /å±•å¼€ description å’Œ suggestion
   - èŠ‚çœå±å¹•ç©ºé—´

2. **å¿«é€Ÿä¿®å¤æŒ‰é’®**
   - å¦‚æœ suggestion åŒ…å«ä»£ç ï¼Œæ·»åŠ "åº”ç”¨ä¿®å¤"æŒ‰é’®
   - è‡ªåŠ¨åº”ç”¨å»ºè®®çš„ä¿®å¤

3. **è§„åˆ™è¯¦æƒ…é“¾æ¥**
   - ç‚¹å‡» rule ID æ‰“å¼€ SonarQube è§„åˆ™æ–‡æ¡£
   - æ˜¾ç¤ºæ›´å¤šå…³äºè§„åˆ™çš„ä¿¡æ¯

4. **ç›¸ä¼¼é—®é¢˜åˆ†ç»„**
   - å°†åŒä¸€è§„åˆ™çš„å¤šä¸ª issues åˆ†ç»„æ˜¾ç¤º
   - æ‰¹é‡ä¿®å¤åŠŸèƒ½

5. **AI å¢å¼ºå»ºè®®**
   - å¯¹äº SonarQube issuesï¼Œä½¿ç”¨ AI ç”Ÿæˆæ›´è¯¦ç»†çš„è§£å†³æ–¹æ¡ˆ
   - æä¾›ä¸Šä¸‹æ–‡ç›¸å…³çš„ä»£ç ç¤ºä¾‹

## å˜æ›´æ–‡ä»¶

- `src/views/git-change-panel.ts` - ä¸»è¦æ›´æ”¹æ–‡ä»¶
  - å¢å¼º `_getIssuesHtml()` æ–¹æ³•
  - æ–°å¢ `_formatIssueType()` æ–¹æ³•
  - æ–°å¢ `_getIssueMetadata()` æ–¹æ³•
  - æ›´æ–° CSS æ ·å¼

## ç›¸å…³æ–‡æ¡£

- [SonarQube API Documentation](https://docs.sonarqube.org/latest/extend/web-api/)
- [VS Code Webview Guide](https://code.visualstudio.com/api/extension-guides/webview)
- [CodeIssue Interface](src/git-analyzer/types/analysis.types.ts)

